<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="CSS/css2.css">
  <link rel="icon" type="image/png" href="img/imgbasquetefavicon.png">
  <title>OlympicBuckets</title>
</head>

<body>
  <header id="header1">
    <a href="index.html">
      <img src="img/imgbasquete.png">
    </a>
    <h1 id="nomedosite3">OlympicBuckets</h1>
  </header>
  <main>
    <div class="peq">
      <h1 class="perguntas"><span>Quantas Medalhas o Brasil Tem No Basquete Olímpico ? </span></h1>
      <input id="input1" type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57"
        placeholder="Quantidade de Medalhas">
      <button onclick="questao1()" id="resp1">Resposta
      </button>
      <div id="resp12"></div>
    </div>
    <div class="peq">
      <h1 class="perguntas"><span>Nas Olimíadas, qual foi o(a) Atleta que mais participou pelos Estados Unidos ? </span>
      </h1>
      <input id="input2" type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')"
        placeholder="Nome do Atleta">
      <button onclick="questao2()" id="resp2">Resposta
      </button>
      <span id="resp22"></span>
    </div>
    <div class="peq">
      <h1 class="perguntas"><span>Qual foi o País vencendor do Basquete Olímpico Masculino em 2016 ?
        </span></h1>
      <input id="input3" type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')" placeholder="Nome do País">
      <button onclick="questao3()" id="resp3">Resposta
      </button>
      <div id="resp32"></div>
    </div>
    <div class="peq">
      <h1 class="perguntas"><span>Em que ano houve a entrada definitiva do Basquete nas Olimpíadas ? </span></h1>
      <input id="input4" type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" placeholder="Ano">
      <button onclick="questao4()" id="resp4">Resposta
      </button>
      <div id="resp42"></div>
    </div>
    <div class="peq">
      <h1 class="perguntas"><span> Cite 1 dos 4 principais jogadores do "Dream Team". </span></h1>
      <input id="input5" type="text" oninput="this.value = this.value.replace(/[0-9]/g, '')" placeholder="Nome do Time">
      <button onclick="questao5()" id="resp5">Resposta
      </button>
      <div id="resp52"></div>
    </div>
  </main>

  <script>
    document.getElementById('loadCsvButton').addEventListener('click', loadCSVData);

    async function loadCSVData() {
      try {
        const response = await fetch('data.csv');
        if (!response.ok) {
          throw new Error('Failed to fetch CSV data');
        }
        const csvText = await response.text();
        return csvText
      } catch (error) {
        console.error('Error:', error.message);
        return null
      }
    }

    async function questao1() {
      try {
        const csvText = await loadCSVData();
        if (!csvText) return;
        const rows = csvText.split('\n');
        const medalhasContadas = {};
        const medalhasBrasilBasquete = rows.reduce((count, row) => {
          const columns = row.split(',');
          if (columns.length >= 15) {
            const country = columns[6].replace(/"/g, '');
            const sport = columns[12].replace(/"/g, '');
            const year = columns[9];
            const event = columns[13].replace(/"/g, '');
            const medalha = columns[14].replace(/"/g, '');
            if (country === 'Brazil' && sport === 'Basketball' && medalha !== 'NA') {
              const chave = year + '-' + event;
              if (!medalhasContadas[chave]) {
                medalhasContadas[chave] = true;
                return count + 1;
              }
            }
          }
          return count;
        }, 0);
        const valorInserido = parseInt(document.getElementById('input1').value);
        if (valorInserido === medalhasBrasilBasquete) {
          document.getElementById('resp12').textContent = 'Certa Resposta';
        } else {
          document.getElementById('resp12').textContent = 'Errado. O Brasil possui ' + medalhasBrasilBasquete + ' medalhas no Basquete Olímpico.';
        }
      } catch (error) {
        console.log('Error:', error.message);
      }
    }

    async function questao2() {
      try {
        const csvText = await loadCSVData();
        if (!csvText) return;
        const rows = csvText.split('\n');
        const playerCounts = {};
        rows.map(row => {
          const columns = row.split(',');
          if (columns.length >= 15) {
            const country = columns[6].replace(/"/g, '');
            const sport = columns[12].replace(/"/g, '');
            const year = columns[9];
            const player = columns[1].replace(/"/g, '');
            const event = columns[13].replace(/"/g, '');

            if (country === 'Estados Unidos' && sport === 'Basketball') {
              const key = `${year}-${event}`;
              playerCounts[player] = playerCounts[player] ? playerCounts[player] + 1 : 1;
            }
          }
        });
        const playerCountEntries = Object.entries(playerCounts);
        const maxPlayerCount = playerCountEntries.reduce((max, [player, count]) => count > max.count ? { player, count } : max, { player: null, count: 0 });

        const maxPlayer = maxPlayerCount.player;
        const maxCount = maxPlayerCount.count;

        const valorInserido = document.getElementById('input2').value;
        if (valorInserido.toLowerCase() === maxPlayerCount.player.toLocaleLowerCase()) {
          document.getElementById('resp22').textContent = 'Certa Resposta';
        } else {
          document.getElementById('resp22').textContent = 'Errado. A Atleta que mais participou pelos Estados Unidos foi ' + maxPlayerCount.player;
        }
      } catch (error) {
        console.error('Error:', error.message);
      }
    }

    async function questao3() {
      try {
        const csvText = await loadCSVData();
        if (!csvText) return;

        const rows = csvText.split('\n');
        const resultado = rows.reduce((ultimoPaisVencedor, row) => {
          const columns = row.split(',');
          if (columns.length >= 15) {
            const year = parseInt(columns[9]); // Convertendo o ano para número inteiro
            const sport = columns[12].replace(/"/g, '');
            const event = columns[13].replace(/"/g, '');
            const medalha = columns[14].replace(/"/g, '');

            if (sport === 'Basketball' && event === "Basketball Men's Basketball" && medalha === 'Gold' && year > (ultimoPaisVencedor ? ultimoPaisVencedor.year : -Infinity)) {
              return { country: columns[6].replace(/"/g, ''), year: year }; // Atualizamos o país vencedor e o ano
            }
          }
          return ultimoPaisVencedor;
        }, null);

        const valorInserido = document.getElementById('input3').value;
        if (resultado.country !== null && valorInserido.toLowerCase() === resultado.country.toLowerCase()) {
          document.getElementById('resp32').textContent = `Certa Resposta. O último país vencedor da Olimpíada de basquete masculino foi: ${resultado.country}`;
        } else {
          document.getElementById('resp32').textContent = `Errado. O último país vencedor do Basquete Olímpico mascullino foi o ${resultado.country}.`;
        }
      } catch (error) {
        console.error('Error:', error.message);
      }
    }

    async function questao4() {
      try {
        const csvText = await loadCSVData();
        if (!csvText) return;

        const rows = csvText.split('\n');
        const anoMaisAntigo = rows.reduce((anoAntigo, row) => {
          const columns = row.split(',');
          if (columns.length >= 15) {
            const year = parseInt(columns[9]);
            const sport = columns[12].replace(/"/g, '');
            return (sport === 'Basketball' && year < anoAntigo) ? year : anoAntigo;
          }
          return anoAntigo;
        }, Infinity);

        const valorInserido = parseInt(document.getElementById('input4').value);
        if (anoMaisAntigo !== Infinity && valorInserido === anoMaisAntigo) {
          document.getElementById('resp42').textContent = `Certa Resposta. O ano em que houve a entrada dos Basquete nas Olimpíadas foi de: ${anoMaisAntigo}`;
        } else {
          document.getElementById('resp42').textContent = `Errado. A entrada definitiva do Basquete ocorreu no ano de ${anoMaisAntigo}.`;
        }
      } catch (error) {
        console.error('Error:', error.message);
      }
    }

    async function questao5() {
      try {
        const csvText = await loadCSVData();
        if (!csvText) return;
        const rows = csvText.split('\n');
        const dreamteam = rows
          .filter(row => {
            const columns = row.split(',');
            if (columns.length >= 15) {
              const nomejogador = columns[1].replace(/"/g, '').trim().toLowerCase();
              return ['michael jordan', 'magic johnson', 'larry bird', 'charles barkley'].includes(nomejogador);
            }
            return false;
          });

        const valorInserido = document.getElementById('input5').value.trim().toLowerCase();
        if (['michael jordan', 'magic johnson', 'larry bird', 'charles barkley'].includes(valorInserido)) {
          document.getElementById('resp52').textContent = `Certa Resposta. A equipe em que ele fazia parte havia sido apelidada de Dream Team em 1992`;
        } else {
          document.getElementById('resp52').textContent = `Errado.`;
        }
      } catch (error) {
        console.error('Error:', error.message);
      }
    }


    function displayCSV(csvText) {
      const csvDiv = document.getElementById('csvData');
      csvDiv.innerHTML = '';
      const rows = csvText.split('\n');
      rows.map(row => {
        const columns = row.split(',');
        const rowDiv = document.createElement('div');
        rowDiv.textContent = `${columns[0]}, ${columns[1]}, ${columns[2]}, ${columns[3]}, ${columns[4]}, ${columns[5]}, ${columns[6]}, ${columns[7]}, ${columns[8]}, ${columns[9]}, ${columns[10]}, ${columns[11]}, ${columns[12]}, ${columns[13]}, ${columns[14]}`;
        csvDiv.appendChild(rowDiv);
      }
      );
    }
  </script>
</body>

</html>
